//=================================================================================================
// Filename:	Bullet.cpp
// Created by:	Daniel Schenker
//=================================================================================================

//=================================================================================================
// Includes
//=================================================================================================

#include "Enemy.h"

//=================================================================================================
// Class Definitions
//=================================================================================================

//-------------------------------------------------------------------------------------------------
// Constructors
//-------------------------------------------------------------------------------------------------

Enemy::Enemy()
	: mPosition(0.0f, 0.0f)
	, mVelocity(0.0f, 0.0f)
	, mTimer(0.0f)
	, mActive(false)
{
	//Empty
}

//-------------------------------------------------------------------------------------------------
// Deconstructor
//-------------------------------------------------------------------------------------------------

Enemy::~Enemy()
{
	//Empty
}

//-------------------------------------------------------------------------------------------------
//SGE Specific
//-------------------------------------------------------------------------------------------------

void Enemy::Load()
{
	mSprite.Load("pikachu.png");
}

//-------------------------------------------------------------------------------------------------

void Enemy::Unload()
{
	mSprite.Unload();
}

//-------------------------------------------------------------------------------------------------

void Enemy::Update(float deltaTime)
{
	if(IsActive())
	{
		mTimer += deltaTime;
		mPosition += mVelocity * deltaTime;

		if(mTimer > 1.0f)
		{
			mTimer = 0.0f;
			mVelocity.x *= -1.0f;
		}

		// HACK: Assume the enemy only goes downwards
		const int kScreenHeight = IniFile_GetInt("WinHeight", 768);
		if(mPosition.y > kScreenHeight + 100.0f)
		{
			Kill();
		}
	}
}

//-------------------------------------------------------------------------------------------------

void Enemy::Render()
{
	if(IsActive())
	{
		const float kHalfWidth = mSprite.GetWidth() * 0.5f;
		const float kHalfHeight = mSprite.GetHeight() * 0.5f;
		SVector2 renderPos(mPosition.x - kHalfWidth, mPosition.y - kHalfHeight);
		mSprite.SetPosition(renderPos);
		mSprite.Render();
	}
}

//-------------------------------------------------------------------------------------------------

void Enemy::Spawn(const SVector2& pos)
{
	mPosition = pos;
	mVelocity = SVector2(100.0f, 100.0f);
	mTimer = 0.0f;
	mActive = true;
}

//-------------------------------------------------------------------------------------------------

void Enemy::Kill()
{
	mActive = false;
}

//-------------------------------------------------------------------------------------------------